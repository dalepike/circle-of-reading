---
interface Props {
  publicUserId: string;
}

const { publicUserId } = Astro.props;
---

<div class="audio-native-wrapper" style="min-height: 90px;">
  <div
    id="elevenlabs-audionative-widget"
    data-height="90"
    data-width="100%"
    data-frameborder="no"
    data-scrolling="no"
    data-publicuserid={publicUserId}
    data-playerurl="https://elevenlabs.io/player/index.html"
  >
    <p class="text-sm text-[var(--color-ink-400)] py-4">Loading audio player...</p>
  </div>
</div>

<script>
  // Load the ElevenLabs script once after DOM is ready
  function loadElevenLabsScript() {
    if (document.querySelector('script[src*="audioNativeHelper"]')) {
      return;
    }

    const script = document.createElement('script');
    script.src = 'https://elevenlabs.io/player/audioNativeHelper.js';
    script.async = true;
    document.body.appendChild(script);
  }

  // Run when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadElevenLabsScript);
  } else {
    loadElevenLabsScript();
  }
</script>
